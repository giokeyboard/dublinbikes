<!DOCTYPE html>
<html lang="en-US">
<head>
    
 <title>Dublin Bike App</title>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

 
</head>
<body>
    <h1 align="center">Dublin Bike App</h1>
    <div id="map" style="width:100%;height:300px;"></div>
   
    <p id="demo1"></p>
    <p id="demo2"></p>
    <p id="demo3"></p>
    <p id="demo4"></p>
    <p id="demo7"></p>
  <input id="searchTextField" type="text" size="50" placeholder="Enter starting point" autocomplete="on" runat="server" onclick="initialize()"/>   
  <input id="searchTextField2" type="text" size="50" placeholder="Enter ending point" autocomplete="on" runat="server" onclick="initialize2()" />
    <p id="demo8"></p>
    <p id="demo9"></p>
    <p id="demo10"></p>
    
<p id="demo11"></p>
    <p id="demo12"></p>
     <p id="demo13"></p>
     <p id="demo14"></p>
        
    
    
   
    Source Latitude    <input type="number" id="demo5">
    Source Longitude  <input type="number"  id="demo6" ><br>
    <input type="submit" onclick="getDistanceFromLatLonInKm()">
    
    
    


 


    
<script>
 
  //<input id="searchTextField" type="text" size="50" placeholder="Enter a location" autocomplete="on" runat="server" />  

    var myObj={{ data|tojson }};
    
    //document.getElementById("demo7").innerHTML=myObj;
    //document.getElementById("demo8").innerHTML=myObj.length;
    //var myObj = JSON.stringify(obj);
      var lat=new Array(myObj.length);
      var long=new Array(myObj.length);
    
    //To get the list of latitude of stations
      for(var i=0;i<myObj.length;i++)
          {
              lat[i]=myObj[i][6];
          }
    //document.getElementById("demo9").innerHTML=typeof(lat[0]);
   // document.getElementById("demo9").innerHTML=lat;
    
    //To get the list of longitude of stations
      for(var i=0;i<myObj.length;i++){
          
          long[i]=myObj[i][7];
          }
        //  document.getElementById("demo2").innerHTML=long;
    
    //To get the list of latitude and longitude of stations as a tuple 
      var latlong=new Array(myObj.length);
      for(var i=0;i<myObj.length;i++)
          {
              latlong[i]=[lat[i],long[i]];
          }
   // document.getElementById("demo10").innerHTML=latlong;
    
    //to fetch the list of station names
    var address_2=new Array(myObj.length);
      for(var i=0;i<myObj.length;i++)
          {
              address_2[i]=myObj[i][0];
          }
    
   // document.getElementById("demo2").innerHTML=latlong.length;
   
var infowindow;
    
  function myMap() {
      
  var myCenter = {lat: 53.349605, lng:-6.264175 };  
  var mapCanvas = document.getElementById("map");
  var mapOptions = {center: myCenter, zoom: 14};
  var map = new google.maps.Map(mapCanvas, mapOptions);
  //var marker = new google.maps.Marker({position:myCenter});
     // var latlong=0;
 //document.getElementById("demo3").innerHTML=latlong[0][1];
  infowindow = new google.maps.InfoWindow({  
            maxWidth: 355
        });    
for(var j=0;j<latlong.length;j++)
    {
        var marker=new google.maps.Marker({
            position:new google.maps.LatLng(latlong[j][0],latlong[j][1]),
            map:map,
            addre:address_2[j],
            latitiude:lat[j],
            longitude:long[j]
            
        });
      popupDirections(marker);
    //   getDistanceFromLatLonInKm(latlong);
       //  marker.setMap(map);
       // popupDirections(marker,address);
       //document.getElementById("demo3").innerHTML=latlong[j][1];
    }
      
}
    
    function popupDirections(marker) {
        //this function created listener listens for click on a marker
        google.maps.event.addListener(marker, 'click', function () {
            for (var i = 0; i <address_2.length; i++)
            { infowindow.setContent("Address: " + marker.addre +"<br>"+"Latitude:" + marker.latitiude+"<br>"+"Longitude:"+marker.longitude); } //sets the content of your global infowindow to string "Tests: "
            infowindow.open(map, marker); //then opens the infowindow at the marker
            
        });
        
      //  initialize();
      //  initialize2();
    }
    
    
    
            //,animation:google.maps.Animation.BOUNCE
function getDistanceFromLatLonInKm() {
    //var place=document.getElementById("demo11");
      //      var x = place.geometry.location.lat();
//var y = place.geometry.location.lng();
     var x=document.getElementById("demo5").value;   //This variable stores the starting year entered 
  var y=document.getElementById("demo6").value;
  var axis =0; // Radius of the earth in km
    var closest_location;  
    var min=0;
            var value=0;
            var dist_array=new Array(latlong.length);
    //document.getElementById("demo2").innerHTML=y;
    for(var i=0;i<latlong.length;i++)
        {
       axis=((x-latlong[i][0])*(x-latlong[i][0]))+((y-latlong[i][1])*(y-latlong[i][1]))
        value=Math.sqrt(axis);
     
dist_array[i]=value;
    // dist_array.toString()       
 //document.getElementById("demo2").innerHTML=dist_array;
        }
   // document.getElementById("demo2").innerHTML=dist_array[111];
  var min = Math.min.apply(Math, dist_array);
    var idx=dist_array.indexOf(Math.min.apply(null,dist_array))
    var nearest_station=address_2[idx];
 document.getElementById("demo4").innerHTML="the minimum distance is "+min; 
    document.getElementById("demo2").innerHTML="The nearest station to your coordinate is "+nearest_station;
 
}
    
    function initialize() {
        var input = document.getElementById('searchTextField');
        var autocomplete = new google.maps.places.Autocomplete(input);
        google.maps.event.addListener(autocomplete, 'place_changed', function () {
            var place = autocomplete.getPlace();
            var latitude = place.geometry.location.lat();
            var longitude=place.geometry.location.lng();

            document.getElementById("demo11").innerHTML=latitude;
            document.getElementById("demo12").innerHTML=longitude;
            //alert("This function is working!");
            //alert(place.name);
           // alert(place.address_components[0].long_name);
            });
        }
    
    
    function initialize2() {
        var input = document.getElementById('searchTextField2');
        var autocomplete = new google.maps.places.Autocomplete(input);
        google.maps.event.addListener(autocomplete, 'place_changed', function () {
            var place = autocomplete.getPlace();
            var latitude = place.geometry.location.lat();
            var longitude=place.geometry.location.lng();

            document.getElementById("demo13").innerHTML=latitude;
            document.getElementById("demo14").innerHTML=longitude;
            //alert("This function is working!");
            //alert(place.name);
           // alert(place.address_components[0].long_name);
            });
        }
    
    google.maps.event.addDomListener(window, 'load', initialize); 
    /*
 https://maps.googleapis.com/maps/api/js?key=AIzaSyBi-bH5_sngxNibrgygRZDhmAv2fK5hzus&callback=myMap&libraries=places   
*/

    </script>
    



 

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3XfuMJJGzaU8TUItQM7XWD4esZdbpgtA&callback=myMap&libraries=places"></script>

    
    
</body>
</html>